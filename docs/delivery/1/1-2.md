# 1-2 Implement session creation endpoint

[Back to task list](./tasks.md)

## Description
Implement Vercel Edge Function `POST /api/sessions` that creates a new session code, saves it to KV with TTL, and returns `{ code, ttl }` JSON.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| <!-- TIMESTAMP --> | Created | N/A | Proposed | Task file created | ai-agent |

## Requirements
* 8-character Base32 code, 40-bit entropy.
* TTL default 10 minutes (configurable).
* Persist `{ createdAt, ttl }` in Vercel KV.
* Return 201 with JSON `{ code, ttl }`.
* Rate-limit: 30 req/min per IP.

## Implementation Plan
1. Add `vercel.json` route for `/api/sessions`.
2. Implement handler in `server/relay/post-session.ts`.
3. Use `@vercel/kv` client for storage.
4. Unit test entropy & response shape.

## Verification
* Jest unit tests pass.
* Manual curl returns valid code.
* KV key exists with correct expiry.

## Files Modified
* `server/relay/post-session.ts` (new)
* `vercel.json`
* `src/test/relay/post-session.test.ts` 